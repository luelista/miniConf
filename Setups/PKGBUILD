# Contributor: luelista <git@luelista.net>

pkgname=miniconf
pkgver=1.7.6
pkgrel=1
pkgdesc="miniConf is a jabber client designed for group chats"
url="http://home.luelista.net/programme/miniconf/"
license="GPL"
arch=('any')
depends=(mono)
source=(https://github.com/luelista/miniConf/archive/v$pkgver-mono.zip)
md5sums=('1a463ce5ce9cc750f36d48a3d22734f8')


build() {
cd "${srcdir}/miniConf-${pkgver}-mono"

xbuild /property:OutputPath="$srcdir/out/"



}

package() {

mkdir -p ${pkgdir}/usr/lib ${pkgdir}/usr/bin
cp -r ${srcdir}/out ${pkgdir}/usr/lib/miniconf

mkdir -p ${pkgdir}/usr/share/man/man1
gzip < ${srcdir}/miniConf-${pkgver}-mono/Docs/miniconf.1 \
	> ${pkgdir}/usr/share/man/man1/miniconf.1.gz

for file in $(ls ${srcdir}/miniConf-${pkgver}-mono/Icons/AppIcon/Jabber*.png); do
  _size=$(basename $file)
  _size=${_size:6:-4}
  mkdir -p ${pkgdir}/usr/share/icons/hicolor/${_size}x${_size}/apps
  cp $file ${pkgdir}/usr/share/icons/hicolor/${_size}x${_size}/apps/miniconf.png
done

mkdir -p ${pkgdir}/usr/share/applications
cp ${srcdir}/miniConf-${pkgver}-mono/Docs/miniConf.desktop ${pkgdir}/usr/share/applications/

cat >${pkgdir}/usr/bin/miniconf <<'END_OF_FILE'
#!/bin/sh

mono /usr/lib/miniconf/miniConf.exe $@

END_OF_FILE

chmod 0755 ${pkgdir}/usr/bin/miniconf

}

